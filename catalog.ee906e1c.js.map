{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/runtime-c64c296fd06d2205.js","src/javascript/pages/catalog-page.js","src/javascript/catalog/components/refs.js","src/javascript/catalog/components/api_service.js","src/javascript/create-error-markup.js","node_modules/@parcel/runtime-js/lib/runtime-4f63533f89ced1db.js","src/javascript/create-movie-card.js","src/javascript/catalog/components/catalog-main.js"],"sourcesContent":["require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"cjRGR\\\":\\\"catalog.ee906e1c.js\\\",\\\"bfHyM\\\":\\\"default.183d728c.jpg\\\",\\\"7gzlR\\\":\\\"catalog.580ed912.js\\\",\\\"26sUF\\\":\\\"catalog.6e26d6d0.js\\\"}\"));","import '../header';\nimport '../hero';\nimport '../catalog/components/catalog-main';\nimport '../modal-trailer';\nimport '../global-listener';\n","export const refs = {\n  searchForm: document.getElementById('movieSearchForm'),\n  searchInput: document.getElementById('movieInput'),\n  catalogList: document.getElementById('movieList'),\n  errorContainer: document.querySelector('.error-container'),\n  searchBtn: document.querySelector('.search-button'),\n  cancelBtn: document.querySelector('.cancel-button'),\n  paginationContainer: document.querySelector('.pagination-pages-list'),\n  paginationButton: document.querySelector('.pagination-button'),\n  nextPageBtn: document.querySelector('.next-button'),\n  prevPageBtn: document.querySelector('.prev-button'),\n};\n","export default class ApiService {\n  static BASE_URL = 'https://api.themoviedb.org/3';\n  static API_KEY = '41b8f9437bf3f899281f8a3f9bdc0891';\n\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.totalAmount = 0;\n  }\n\n  async getMovies() {\n    const options = {\n      method: 'GET',\n      headers: {\n        accept: 'application/json',\n        Authorization: `Bearer ${ApiService.API_KEY}`,\n      },\n    };\n\n    let url = '';\n    if (this.searchQuery) {\n      url = `${ApiService.BASE_URL}/search/movie?api_key=${ApiService.API_KEY}&query=${this.searchQuery}&include_adult=false&language=en-US&page=${this.page}`;\n    } else {\n      url = `${ApiService.BASE_URL}/trending/all/week?api_key=${ApiService.API_KEY}&language=en-US&page=${this.page}`;\n    }\n\n    try {\n      const response = await fetch(url, options);\n      const movies = await response.json();\n      return movies;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  decrementPage() {\n    this.page -= 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  get total() {\n    return this.totalAmount;\n  }\n\n  set total(newTotal) {\n    this.totalAmount = newTotal;\n  }\n\n  resetTotal() {\n    this.totalAmount = 0;\n  }\n}\n","import { refs } from './catalog/components/refs';\n\nlet errorMarkupCreated = false;\n\nexport const createErrorMarkup = () => {\n\n  if (errorMarkupCreated) {\n    return;\n  }\n\n  const errorMarkup = `<p class=\"error-information\">OOPS...</p>\n  <p class=\"error-information\">We are very sorry!</p>\n  <p class=\"error-information\">\n    We don’t have any results matching your search.\n  </p>`;\n\n  const newErrorContainer = document.createElement('div');\n  newErrorContainer.innerHTML = errorMarkup;\n\n  refs.errorContainer.appendChild(newErrorContainer);\n  errorMarkupCreated = true;\n};\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"bfHyM\")).toString();","import { refs } from './catalog/components/refs';\nimport defaultImg from '../images/default.jpg';\nimport starsRating from './stars-rating';\nimport { validateGenres } from './weekly-trends-genres';\nimport { openModalAboutFilm } from './movieModal';\n\nexport async function createMovieCard(data) {\n  const genresData = JSON.parse(localStorage.getItem('genres'));\n\n  const markupPromises = data.results.map(async movie => {\n    const imageSrc = movie.poster_path\n      ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n      : `${defaultImg}`;\n    const genresPromise = validateGenres(movie.genre_ids, genresData);\n    const genres = await genresPromise;\n    return `<li class=\"card-item\" data-id=\"${movie.id}\">\n        <img class=\"film-poster\" src=\"${imageSrc}\" alt=\"${\n      movie.original_title || movie.name\n    }\" />\n        <div class=\"overlay\">\n          <div class=\"film-info\">\n            <p class=\"film-title\">${movie.original_title || movie.name}</p>\n            <div class=\"film-details\">\n              <span class=\"film-description\">${genres} | ${\n      new Date(movie.release_date).getFullYear() ||\n      new Date(movie.first_air_date).getFullYear()\n    }</span>\n    <div class=\"stars-container\">${starsRating({\n      voteAverage: movie.vote_average,\n      isHero: false,\n    })}</div>            \n      <!-- <span class=\"film-rating\">${movie.vote_average.toFixed(1)}</span> -->\n            </div>\n          </div>\n        </div>\n      </li>`;\n  });\n\n  const markup = await Promise.all(markupPromises);\n\n  refs.catalogList.innerHTML = markup.join('');\n\n  const filmList = document.querySelector('.listListener');\n\n  filmList.addEventListener('click', event => {\n    const li = event.target.closest('.card-item');\n    const movieId = li.getAttribute('data-id');\n    openModalAboutFilm(movieId);\n  });\n}\n","// Імпорти\nimport { refs } from './refs';\nimport ApiService from './api_service';\nimport { createErrorMarkup } from '../../create-error-markup';\nimport { createMovieCard } from '../../create-movie-card';\n\n// Змінні\nconst apiService = new ApiService();\n\nconst wrapper = document.querySelector('.pagination-wrapper');\n\nlet currentPage = 1;\nlet totalPages = 0;\n\n// Слухачі подій\n\nrefs.searchForm.addEventListener('submit', getInputValue);\nrefs.cancelBtn.addEventListener('click', clearInputValue);\nrefs.searchInput.addEventListener('input', onInput);\nrefs.nextPageBtn.addEventListener('click', onNextPage);\nrefs.prevPageBtn.addEventListener('click', onPrevPage);\nrefs.paginationContainer.addEventListener('click', onPageButtonClick);\n\n// Приховання елементів\n\nrefs.errorContainer.classList.add('is-hidden');\nrefs.cancelBtn.classList.add('is-hidden');\n\n// Запит трендів тижня\n\nrenderWeeklyTrends(currentPage);\n\n// Функції\n\nfunction renderWeeklyTrends(page) {\n  apiService.getMovies(page).then(handleMoviesData).catch(handleError);\n}\n\nfunction handleMoviesData(data) {\n  totalPages = data.total_pages;\n  createMovieCard(data);\n  updateNextButtonState(data.total_pages);\n  createPaginationButtons(totalPages, currentPage);\n}\n\nfunction handleError(error) {\n  refs.catalogList.innerHTML = '';\n  createErrorMarkup();\n  console.error('An error occurred:', error);\n}\n\nfunction getInputValue(e) {\n  e.preventDefault();\n\n  refs.paginationContainer.classList.remove('is-hidden');\n  refs.errorContainer.classList.add('is-hidden');\n\n  const query = refs.searchInput.value.trim();\n  apiService.query = query;\n  apiService.resetPage();\n  apiService.resetTotal();\n\n  if (query === '') {\n    handleEmptyQuery();\n  } else {\n    searchMovies();\n  }\n}\n\nfunction handleEmptyQuery() {\n  refs.catalogList.innerHTML = '';\n\n  refs.errorContainer.classList.remove('is-hidden');\n  wrapper.classList.add('is-hidden');\n  createErrorMarkup();\n}\n\nasync function searchMovies() {\n  try {\n    const data = await apiService.getMovies();\n    if (data.total_results === 0) {\n      handleEmptyQuery();\n    } else {\n      wrapper.classList.remove('is-hidden');\n      totalPages = data.total_pages;\n      apiService.total = data.total_results;\n      createMovieCard(data);\n      currentPage = data.page;\n      createPaginationButtons(totalPages, currentPage);\n    }\n    refs.searchInput.value = '';\n  } catch (error) {\n    handleError(error);\n  }\n}\n\nfunction onInput(e) {\n  if (e.currentTarget.value.trim()) {\n    refs.cancelBtn.classList.remove('is-hidden');\n  } else {\n    refs.cancelBtn.classList.add('is-hidden');\n  }\n}\n\nfunction clearInputValue() {\n  refs.cancelBtn.classList.add('is-hidden');\n  refs.searchInput.value = '';\n}\n\n// Пагінація\n\nfunction createPaginationButtons(totalPages, page) {\n  let liTag = '';\n  let afterPage = page + 1;\n  let beforePage = page - 1;\n  let active = '';\n\n  if (totalPages > 5) {\n    if (page > 2) {\n      liTag += `<li class=\"pagination-item\">\n        <button type=\"button\" class=\"pagination-button\">1</button>\n      </li>`;\n      if (page > 3) {\n        liTag += `<li class=\"pagination-item\">\n          <button type=\"button\" class=\"pagination-dots\">...</button>\n        </li>`;\n      }\n    }\n  }\n\n  if (page == totalPages) {\n    beforePage = beforePage - 1;\n  } else if (page == totalPages - 1) {\n    beforePage = beforePage - 1;\n  }\n  if (page == 1) {\n    afterPage = afterPage + 1;\n  } else if (page == 2) {\n    afterPage = afterPage + 1;\n  }\n\n  for (let plength = beforePage; plength <= afterPage; plength++) {\n    if (plength > totalPages || plength < 1) {\n      continue;\n    }\n    if (page == plength) {\n      active = 'is-active';\n    } else {\n      active = '';\n    }\n    liTag += `<li class=\"pagination-item\">\n      <button type=\"button\" class=\"pagination-button ${active}\">${plength}</button>\n    </li>`;\n  }\n\n  if (totalPages > 5) {\n    if (page < totalPages - 1) {\n      if (page < totalPages - 2) {\n        liTag += `<li class=\"pagination-item\">\n        <button type=\"button\" class=\"pagination-dots\">...</button>\n      </li>`;\n      }\n      liTag += `<li class=\"pagination-item\">\n      <button type=\"button\" class=\"pagination-button\">${totalPages}</button>\n    </li>`;\n    }\n  }\n\n  refs.paginationContainer.innerHTML = liTag;\n  return liTag;\n}\n\nfunction onPageButtonClick(event) {\n  if (event.target.tagName === 'BUTTON') {\n    const newPage = parseInt(event.target.textContent);\n    if (!isNaN(newPage) && newPage !== currentPage) {\n      currentPage = newPage;\n      apiService.page = newPage;\n      renderWeeklyTrends(currentPage);\n    }\n  }\n}\n\nfunction updateNextButtonState(totalPages) {\n  if (currentPage === totalPages) {\n    refs.nextPageBtn.setAttribute('disabled', 'disabled');\n  }\n}\n\nfunction onNextPage() {\n  currentPage += 1;\n  apiService.incrementPage();\n  renderWeeklyTrends(currentPage);\n}\n\nfunction onPrevPage() {\n  if (currentPage > 1) {\n    currentPage -= 1;\n    apiService.decrementPage();\n    renderWeeklyTrends(currentPage);\n  }\n}\n"],"names":["parcelRequire","register","JSON","parse","$f24ca30804b692bc$export$21666b427502ea6d","searchForm","document","getElementById","searchInput","catalogList","errorContainer","querySelector","searchBtn","cancelBtn","paginationContainer","paginationButton","nextPageBtn","prevPageBtn","$0310c26536a7e8b6$export$2e2bcd8739ae039","static","constructor","this","searchQuery","page","totalAmount","async","options","method","headers","accept","Authorization","API_KEY","url","BASE_URL","response","fetch","json","error","console","incrementPage","decrementPage","resetPage","query","newQuery","total","newTotal","resetTotal","$ee45b6d67387685f$var$errorMarkupCreated","$ee45b6d67387685f$export$7e018aa348c28d8","newErrorContainer","createElement","innerHTML","appendChild","$d77a59c1df57a7d8$exports","URL","resolve","import","meta","toString","$72f7299367b39c69$export$9d27b867a89df126","data","genresData","localStorage","getItem","markupPromises","results","map","movie","imageSrc","poster_path","$parcel$interopDefault","genresPromise","$5bV6Z","validateGenres","genre_ids","genres","id","original_title","name","Date","release_date","getFullYear","first_air_date","$7DS8N","default","voteAverage","vote_average","isHero","toFixed","markup","Promise","all","join","addEventListener","event","movieId","target","closest","getAttribute","$a3ItO","openModalAboutFilm","$320cdd08d46b3a16$var$apiService","$320cdd08d46b3a16$var$wrapper","$320cdd08d46b3a16$var$currentPage","$320cdd08d46b3a16$var$totalPages","$320cdd08d46b3a16$var$renderWeeklyTrends","getMovies","then","$320cdd08d46b3a16$var$handleMoviesData","catch","$320cdd08d46b3a16$var$handleError","totalPages2","total_pages","setAttribute","$320cdd08d46b3a16$var$createPaginationButtons","$320cdd08d46b3a16$var$handleEmptyQuery","classList","remove","add","totalPages1","liTag","afterPage","beforePage","active","plength","e","preventDefault","value","trim","total_results","$320cdd08d46b3a16$var$searchMovies","currentTarget","tagName","newPage","parseInt","textContent","isNaN"],"version":3,"file":"catalog.ee906e1c.js.map"}